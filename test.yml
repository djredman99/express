jobs:
- job: Windows_MustPass
  strategy:
    maxParallel: 10
    matrix:
      Node 1.8:
        NODE_VERSION: '1.8'

  continueOnError: false
  pool:
    vmImage: 'vs2017-win2016'

  steps:
  # - task: NodeTool@0
  #  displayName: "Use Node $(NODE_VERSION)"
  #  inputs:
  #    versionSpec: $(NODE_VERSION)
  #    checkLatest: true

  - powershell: |
      $iojsUrl = "https://iojs.org/dist/v1.8.4/iojs-v1.8.4-x64.msi"
      $file = Join-Path "$(agent.tempDirectory)" "mickey.msi"
      Invoke-WebRequest -Uri $iojsUrl -OutFile $file
      dir $(agent.tempDirectory)

      Start-Process -FilePath "$env:systemroot\system32\msiexec.exe" -ArgumentList "/i `"$file`" /n /passive /l:$(agent.tempDirectory)\mylog.log" -Wait -WorkingDirectory $(agent.TempDirectory) -PassThru

      dir $agent.tempDirectory

  - powershell: |
      $env:Path
      node --version

